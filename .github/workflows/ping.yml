name: Keep Render Backend Alive

on:
  schedule:
    - cron: "*/5 * * * *"   # Ping every 5 minutes (prevents sleep completely)
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render Backend (with retry)
        run: |
          echo "Pinging Render backend…"

          # Try up to 3 times, short timeout, exit quietly on failure
          for i in 1 2 3; do
            curl -s --max-time 8 https://weather-backend-e8cz.onrender.com/weather?city=Delhi && break
            echo "Ping attempt $i failed, retrying…"
            sleep 3
          done

          echo "Ping completed."
